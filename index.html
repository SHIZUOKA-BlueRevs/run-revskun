<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ãƒãƒ¼ãƒ å…¬å¼ãƒŸãƒ‹ã‚²ãƒ¼ãƒ </title>
    <style>
        /* ç”»é¢ã„ã£ã±ã„ã«è¡¨ç¤ºã™ã‚‹è¨­å®š */
        body { margin: 0; padding: 0; overflow: hidden; background: #eee; font-family: sans-serif; }
        canvas { display: block; background: #fff; width: 100vw; height: auto; touch-action: manipulation; }
        
        /* ã‚¹ã‚³ã‚¢ã®æ–‡å­—ã‚’å¤§ãã */
        #scoreDisplay {
            position: absolute; top: 10px; left: 20px;
            font-size: 30px; font-weight: bold; color: #333;
        }

        /* æ¨ªå‘ãæ¨å¥¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆç¸¦ã®æ™‚ã ã‘è¡¨ç¤ºï¼‰ */
        @media screen and (orientation: portrait) {
            #orientation-msg { display: flex; }
        }
        #orientation-msg {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); color: white;
            justify-content: center; align-items: center; text-align: center; z-index: 100;
            font-size: 20px; padding: 20px; box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div id="orientation-msg">ğŸ“± ç”»é¢ã‚’ã€æ¨ªå‘ãã€‘ã«ã™ã‚‹ã¨<br>å¤§ããè¡¨ç¤ºã•ã‚Œã¦éŠã³ã‚„ã™ã„ã§ã™ã‚ˆï¼</div>
    <div id="scoreDisplay">Score: 0</div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // ç”»é¢ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦èª¿æ•´
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        let score = 0;
        let gameActive = true;
        let gameSpeed = canvas.width / 100; // ç”»é¢å¹…ã«åˆã‚ã›ãŸé€Ÿåº¦

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‚å¤§ãã‚ã«è¨­å®šï¼ˆè€çœ¼å¯¾å¿œï¼‰
        const player = {
            x: 50, y: 0, 
            width: 80, height: 80, // ã‚µã‚¤ã‚ºã‚¢ãƒƒãƒ—ï¼
            color: "#E60012", // ãƒãƒ¼ãƒ ã‚«ãƒ©ãƒ¼ä¾‹
            dy: 0, jumpForce: 15, gravity: 0.8, grounded: false
        };

        let obstacles = [];
        function spawnObstacle() {
            if (!gameActive) return;
            const size = 60 + Math.random() * 40; // éšœå®³ç‰©ã‚‚å¤§ãã
            obstacles.push({
                x: canvas.width, y: canvas.height - size - 20,
                width: size, height: size, color: "#333"
            });
            setTimeout(spawnObstacle, Math.random() * 1500 + 800);
        }

        function jump() {
            if (player.grounded && gameActive) {
                player.dy = -player.jumpForce;
                player.grounded = false;
            }
            if (!gameActive) location.reload();
        }

        window.addEventListener("touchstart", (e) => { e.preventDefault(); jump(); });
        window.addEventListener("mousedown", jump);

        function update() {
            if (!gameActive) return;

            player.dy += player.gravity;
            player.y += player.dy;

            // åœ°é¢ã®åˆ¤å®šï¼ˆç”»é¢ã®ä¸€ç•ªä¸‹ã‹ã‚‰å°‘ã—ä¸Šã«è¨­å®šï¼‰
            const groundY = canvas.height - player.height - 20;
            if (player.y > groundY) {
                player.y = groundY;
                player.dy = 0;
                player.grounded = true;
            }

            obstacles.forEach((obs, index) => {
                obs.x -= gameSpeed;
                // å½“ãŸã‚Šåˆ¤å®š
                if (player.x < obs.x + obs.width &&
                    player.x + player.width > obs.x &&
                    player.y < obs.y + obs.height &&
                    player.y + player.height > obs.y) {
                    gameActive = false;
                }
                if (obs.x + obs.width < 0) {
                    obstacles.splice(index, 1);
                    score++;
                    document.getElementById("scoreDisplay").innerText = "Score: " + score;
                    gameSpeed += 0.1;
                }
            });

            draw();
            requestAnimationFrame(update);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // åœ°é¢ã‚’æã
            ctx.fillStyle = "#333";
            ctx.fillRect(0, canvas.height - 20, canvas.width, 2);

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // éšœå®³ç‰©
            ctx.fillStyle = "#777";
            obstacles.forEach(obs => {
                ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
            });

            if(!gameActive) {
                ctx.fillStyle = "rgba(0,0,0,0.7)";
                ctx.fillRect(0,0,canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.font = "bold 40px sans-serif";
                ctx.textAlign = "center";
                ctx.fillText("ã‚²ãƒ¼ãƒ çµ‚äº†ï¼", canvas.width/2, canvas.height/2);
                ctx.font = "20px sans-serif";
                ctx.fillText("ç”»é¢ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦", canvas.width/2, canvas.height/2 + 60);
            }
        }

        spawnObstacle();
        update();
    </script>
</body>
</html>